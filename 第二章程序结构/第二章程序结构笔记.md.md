# 第2章程序结构

## 2.1 Go语言程序元素

包含`5`种符号：标识符（identifier）、关键字（keyword）、运算符（operator）、分隔符（delimiter）与字面量（literal）。它们是组成Go语言代码和程序的最基本单位，这5种符号共同组成各种表达式和语句。

### 2.1.1 标识符

Go语言标识符是用于`标识变量`、`函数`或任何用户`自定义项目的名称`（程序实体）。
标识符有两种类别，一种是用户定义的标识符，它作为程序实体存在，一般来说同一个代码块中不允许程序实体同名，使用不同代码包中的实体需要使用包标识符表明，例如前面遇到过的`fmt.Println`表示的是使用`fmt`包中的`Println`标识符。

另一种标识符称为预定义标识符，它们在Go语言源代码中声明。例如数据类型：`bool`、`byte`、`uint16`、`float32`、`float64`、`int`、`int8`、`int16`、`uint32`、`int32`、`int64`、`uint64`、`string`、`uint`、`uint8`、`uintptr`；内建函数名：`append`、`cap`、`close`、`complex`、`copy`、`delete`、`imag`、`len`、`make`、`new`、`panic`、`print`、`println`、`real`、`recover`；其他标识符：`iota`、`nil`、`_`。

最后一个`_`叫作空标识符，一般用在变量声明与包的导入中，例如Go语言程序中，若存在一个没有使用的变量a，那么编译时会报错，因为Go语言要求存在实体必须使用，所以可以加一句`_=a`这样的代码，这样Go语言编译器会认为使用了`a`变量，也就不会报错了，而实际上并没有对变量`a`做任何操作。程序初始化后空标识符就会被释放。

在标识符中不允许使用标点符号，例如`@`、`$`、`%`等一系列符号。

标识符区分大小写。


### 2.1.2 关键字

`25`个关键字。

- 包导入与声明：import、package。
- 程序实体声明与定义：`var`、`type`、`func`、`interface`、`map`、`struct`、`chan`、`const`。
- 流程控制：`if`、`continue`、`for`、`return`、`go`、`case`、`goto`、`switch`、`select`、`else`、`break`、`default`、`defer`、`fallthrough`、`range`。

也称保留字，还有一个特殊的空接口类型，字面量是“_”（下划线）。

### 2.1.3 字面量

字面量就是表示值的一种标记法，用于表示基础数据类型值的各种字面量；其次用于表示用户构造的自定义复合数据类型的类型字面量；还用于表示复合数据类型的值的复合字面量，简单来说，它会被用来构造类型`Struct`（结构体）、`Array`（数组）、`Slice` （切片）和`Map`（字典）的值。举例如下：

```
const b int = 10 //b为常量，10为字面量
var str string = "hello world" // str为变量，hello world为字面量
```

### 2.1.4 分隔符

- 括号分隔符：`括号`、`中括号`、`大括号`；
- 标点分隔符：`小数点`、`逗号`、`分号`、`冒号`和`省略号`。

程序代码都是通过语句来实现结构化，不需要以分号（`;`）结尾，多个语句写在同一行需要，但不推荐。

### 2.1.5 运算符

运算符是用于执行运算或逻辑操作的符号。和其它语言类似，举几个特殊的例子说明。

- `*` ：乘积操作，二元算术运算符。同时也是一元地址运算符，表示取值操作；
- `|` ： 按位或操作，二元算术运算符，例如5 | 11 返回15；
- `^` ：按位异或操作，二元算术运算符，例如5 ^ 11返回14。同时也是一元运算运算符，表示按位取补码操作，例如^5返回-6；
- `<<` : 按位左移操作，二元算术运算符，例如4<<2返回16。
- `>>` : 按位右移操作，二元算术运算符，例如4>>2返回1。
- `&`：按位与操作，二元算术运算符，例如 5&11返回1。同时也是一元地址运算符，表示取址操作，例如&str返回str所在的内存地址；
- `&^` : 按位清除操作，二元算术运算符，例如5&11返回4。

一元运算符的优先级高于二元运算符。

二元运算符优先级表

|  运算符   | 优先级  
|  :-:   | :-:  | 
| *  /  %  <<  >>  &  &^  | 最高| 
| +  -  \|   ^  | 较高 | 
| ==  !=  <  <=  >  >=  | 中 | 
| &&  | 较低 | 
| \|\|  | 最低 | 

同级运算符按从左往右的顺序依次操作。括号内的优先执行。

`++`和`--`是语句，不是表达式，没有运算符优先级之说。

```

	func main() {
		  n := 0
		  p := &n
	      // b := n++
		  // if n++ == 1 {}
	      // ++n
		  n++
		  *p++
	      fmt.Println(n)
	}

```

Go语言不支持`运算符重载`。

### 2.1.6 注释

注释语法

- //
- /*  */

## 2.2 Go语言基本概念

如何定义`常量`、`变量`，程序实体的命名有怎样的规则，以及声明一个实体有哪些需要注意的地方。

### 2.2.1 常量

常量可定义为`数值`（`整形`、`浮点型`和`复数`类型）、`布尔值`或`字符串`等类型。

智能判断值的类型。

- 显式定义：const h string = "hello"
- 隐式定义：const w =world ""

常量支持超长的小数位数，可以在定义常量的表达式中使用反斜杠作为跨行的连接符使用，与Linux的shell命令一样。

```
	const Pi = 3.141592653589793\
	             2384264338327950288\
				 4197169399375105820974944\
				 5923078164062862089986280348253421170679
```

常量的值在编译时可以确定，也就是说可以在其`赋值表达式中涉及计算过程`，但是必须在编译期间就能确定所有用于计算常量的值。

```
	const c1 = 6/3  // 2
	
	// const c2 = getNumber(member) // getNumber是用户自定义函数，不确定
	/* 在编译期间，自定义函数返回的值未知，所以不能赋值给常量。
	   但内置函数可以，例如：len()函数。*/
	n := "hello"
	l := len(n) //返回5

```

与Go语言的数字变量相比，Go语言的数字常量不需要考虑类型转换问题，但需要注意常量赋值给精度过小的数字变量而导致`溢出`的情况，这会在编译期间报错。

1. 数字表示：可以是`十进制`、`八进制`（前缀为0）、或`十六进制`（前缀为0x或0X）。整数还可以有一个后缀，它是`U`和`L`的组合，分别用于表示`unsigned`和`long`。后缀可以是大小写字母，顺序也是任意的。示例如下：
  - 0xFeeL   // 十六进制，合法
  - 30u // 无符号整形，合法
  - 30l  // long，合法
  - 30ul //无符号long，合法
  - 078 //非法 ，8不是八进制数字
  - 032UU // 非法，后缀重复
  
  2. 转义字符：使用`反斜杠`表示转义符号

常见转义代码列表

|  转义序列   | 含义  
|  :-:   | :-:  | 
| \\\\| \\ 字符| 
|  \\b | 退格 | 
| \\f  | 换页 | 
| \\n  | 新行 | 
| \\r|  回车| 
| \\t|  水平制表符|
| \\v|  垂直制表符|

示例：见 `转义字符.go`。

3. 赋值：见 `赋值.go`。

4. 枚举：见 `枚举.go`。

### 2.2.2 变量

1. 变量的申明：见 `变量申明.go`。

变量是Go语言中表示抽象值和储存计算结果的一种概念。命名规则和常量一样。

声明格式是：var indentifier type 。之所以将变量的类型放在变量的名称后面，原因有多种，其中一点是为了避免像C语言中出现有歧义的声明情况，具体讨论详见：

> https://blog.golang.org/declaration-syntax

2. 局部变量声明：见 `局部变量申明.go`。

3. 匿名变量：见 `匿名变量.go`。











